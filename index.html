<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Picfast - Free Image Upload & Share | Fast Image Hosting</title>
  <meta name="description" content="Picfast is a free, fast, and reliable image upload and hosting service. Instantly upload your pictures and get shareable links for forums, blogs, social media, and more. No registration required.">
  <meta name="keywords" content="image upload, free image hosting, photo sharing, direct link, hotlink, JPG, PNG, GIF, WebP, HEIC, Picfast">
  <link rel="icon" type="image/png" href="logo.png">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .main-content {
      flex: 1 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      width: 100%;
      padding-top: 64px;
    }
    .site-footer {
      flex-shrink: 0;
    }
    body { font-family: 'Inter', 'Segoe UI', Arial, sans-serif; margin: 0; padding: 0; background: #f6f8fb; }
    
    /* Header Styles */
    .main-header {
      background: #fff;
      border-bottom: 1px solid #e1e5e9;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 2000;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 0;
    }
    
    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 64px;
    }
    
    .logo {
      display: flex;
      align-items: center;
    }
    
    .logo-img {
      height: 32px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    
    .logo-img:hover {
      transform: scale(1.05);
    }
    
    .main-nav {
      display: flex;
      gap: 32px;
      align-items: center;
    }
    
    .nav-link {
      text-decoration: none;
      color: #666;
      font-weight: 500;
      font-size: 14px;
      padding: 8px 16px;
      border-radius: 6px;
      transition: all 0.2s;
      position: relative;
    }
    
    .nav-link:hover {
      color: #007bff;
      background: #f8f9fa;
    }
    
    .nav-link.active {
      color: #007bff;
      background: #e3f2fd;
    }
    
    .user-actions {
      display: flex;
      gap: 12px;
      align-items: center;
    }
    
    .login-btn {
      text-decoration: none;
      color: #007bff;
      font-weight: 500;
      font-size: 14px;
      padding: 8px 16px;
      border-radius: 6px;
      transition: all 0.2s;
    }
    
    .login-btn:hover {
      background: #f8f9fa;
    }
    
    .signup-btn {
      text-decoration: none;
      color: #fff;
      background: #007bff;
      font-weight: 500;
      font-size: 14px;
      padding: 8px 16px;
      border-radius: 6px;
      transition: all 0.2s;
    }
    
    .signup-btn:hover {
      background: #0056b3;
    }
    
    .mobile-menu-btn {
      display: none;
      flex-direction: column;
      gap: 4px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
    }
    
    .mobile-menu-btn span {
      width: 24px;
      height: 2px;
      background: #666;
      transition: all 0.3s;
    }
    
    /* Desktop styles - hide mobile menu */
    .mobile-menu {
      display: none;
    }
    
    /* Mobile responsive */
    @media (max-width: 768px) {
      .main-nav {
        display: none;
      }
      
      .user-actions {
        display: none;
      }
      
      .mobile-menu-btn {
        display: flex;
      }
      
      .header-content {
        padding: 0 15px;
      }
      
      /* Mobile menu styles */
      .mobile-menu {
        display: block;
        position: fixed;
        top: 64px;
        left: 0;
        right: 0;
        background: #fff;
        border-bottom: 1px solid #e1e5e9;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transform: translateY(-100%);
        transition: transform 0.3s ease;
        z-index: 999;
      }
      
      .mobile-menu.show {
        transform: translateY(0);
      }
      
      .mobile-menu-content {
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      
      .mobile-nav-link {
        text-decoration: none;
        color: #666;
        font-weight: 500;
        font-size: 16px;
        padding: 12px 16px;
        border-radius: 6px;
        transition: all 0.2s;
      }
      
      .mobile-nav-link:hover {
        color: #007bff;
        background: #f8f9fa;
      }
      
      .mobile-nav-link.active {
        color: #007bff;
        background: #e3f2fd;
      }
      
      .mobile-user-actions {
        display: flex;
        gap: 12px;
        margin-top: 16px;
        padding-top: 16px;
        border-top: 1px solid #e1e5e9;
      }
      
      .mobile-login-btn {
        text-decoration: none;
        color: #007bff;
        font-weight: 500;
        font-size: 16px;
        padding: 12px 16px;
        border-radius: 6px;
        transition: all 0.2s;
        flex: 1;
        text-align: center;
      }
      
      .mobile-signup-btn {
        text-decoration: none;
        color: #fff;
        background: #007bff;
        font-weight: 500;
        font-size: 16px;
        padding: 12px 16px;
        border-radius: 6px;
        transition: all 0.2s;
        flex: 1;
        text-align: center;
      }
    }
    .page-title {
      text-align: center;
      padding: 40px 20px 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    
    h1 {
      text-align: center;
      font-size: 3.5rem;
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      font-weight: 900;
      margin-bottom: 0;
      letter-spacing: 0.03em;
      line-height: 1.12;
      width: 100%;
    }
    .subtitle {
      text-align: center;
      color: #888;
      margin-top: 60px;
      margin-bottom: 48px;
      font-size: 1.18rem;
      font-weight: 400;
      letter-spacing: 0.01em;
    }
    #dropArea {
      border: 2.5px solid #b3d8fd;
      border-radius: 12px;
      padding: 36px 0;
      text-align: center;
      color: #007bff;
      background: #fafdff;
      margin-bottom: 38px;
      width: 100%;
      font-size: 1.13rem;
      transition: background 0.2s, border-color 0.2s, box-shadow 0.2s;
      cursor: pointer;
      font-weight: 500;
      box-shadow: 0 2px 12px rgba(0,123,255,0.04);
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    #dropArea.dragover {
      background: #eaf4ff;
      border-color: #90c2fa;
      color: #0056b3;
      box-shadow: 0 4px 24px rgba(0,123,255,0.10);
    }

    button[type="submit"] {
      background: linear-gradient(90deg, #2196f3 0%, #007bff 100%);
      color: #fff;
      border: none;
      border-radius: 8px;
      transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
      box-shadow: 0 2px 8px rgba(0,123,255,0.08);
      font-size: 1.22rem;
      font-weight: 700;
      padding: 0 48px;
      margin-top: 10px;
      margin-bottom: 18px;
      width: auto;
      min-width: 220px;
      outline: none;
      height: 54px;
      line-height: 54px;
      display: flex;
      align-items: center;
      justify-content: center;
      letter-spacing: 0.01em;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    button[type="submit"]:hover, button[type="submit"]:focus {
      background: linear-gradient(90deg, #007bff 0%, #2196f3 100%);
      box-shadow: 0 6px 24px rgba(0,86,179,0.13);
      transform: translateY(-2px) scale(1.03);
    }
    button[type="button"] {
      background: linear-gradient(90deg, #2196f3 0%, #007bff 100%);
      color: #fff;
      border: none;
      border-radius: 8px;
      transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
      box-shadow: 0 2px 8px rgba(0,123,255,0.08);
      font-size: 1rem;
      font-weight: 600;
      padding: 8px 18px;
      outline: none;
      margin-left: 6px;
    }
    button[type="button"]:hover, button[type="button"]:focus {
      background: linear-gradient(90deg, #007bff 0%, #2196f3 100%);
      box-shadow: 0 6px 24px rgba(0,86,179,0.13);
      transform: translateY(-1px) scale(1.04);
    }
    button[onclick^="deleteHistory"] {
      background: #f44336 !important;
      color: #fff !important;
      border-radius: 8px;
      margin-left: 6px;
      box-shadow: 0 2px 8px rgba(244,67,54,0.08);
      font-weight: 600;
    }
    button[onclick^="deleteHistory"]:hover, button[onclick^="deleteHistory"]:focus {
      background: #d32f2f !important;
      box-shadow: 0 6px 24px rgba(244,67,54,0.13);
    }
    #fileRow {
      width: 100%;
      margin-bottom: 10px;
    }
    #fileName {
      font-size: 1.05rem;
      color: #555;
      font-weight: 400;
    }
    .result {
      margin-top: 38px;
      text-align: center;
      font-size: 1.13rem;
      width: 100%;
      max-width: 480px;
      margin-left: auto;
      margin-right: auto;
      background: none;
      border-radius: 0;
      box-shadow: none;
      padding: 0;
      display: none;
    }
    .result.show {
      display: block;
    }
    .result img {
      border-radius: 10px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.08);
      margin-bottom: 18px;
      max-width: 100%;
      height: auto;
    }
    .result .copy-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 12px;
    }
    .result input[type="text"] {
      width: 60%;
      font-size: 0.98rem;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 6px 8px;
      background: #fafbfc;
      margin-right: 0;
    }
    .result button[type="button"] {
      margin-left: 0;
      min-width: 70px;
    }
    .result a {
      color: #007bff;
      text-decoration: underline;
      font-size: 1.08rem;
      margin-top: 10px;
      display: inline-block;
    }
    /* 上传区与按钮间距拉开 */
    #dropArea {
      margin-bottom: 38px;
    }
    #history {
      margin-top: 40px;
      background: #f8f9fa;
      border-radius: 10px;
      padding: 22px 16px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.04);
      width: 100%;
      max-width: 600px;
    }
    #history b {
      font-size: 1.13rem;
      font-weight: 700;
    }
    #history a {
      color: #007bff;
      word-break: break-all;
    }
    #history img {
      display: block;
      margin: 8px auto 0 auto;
      border-radius: 6px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
    }
    #history hr {
      margin: 16px 0;
    }
    #toast {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%,-50%) scale(0.98);
      background: rgba(30, 30, 30, 0.82);
      color: #fff;
      padding: 20px 36px;
      border-radius: 22px;
      font-size: 1.13rem;
      z-index: 9999;
      box-shadow: 0 6px 32px 0 rgba(0,0,0,0.18), 0 1.5px 6px 0 rgba(0,0,0,0.10);
      text-align: center;
      min-width: 180px;
      max-width: 92vw;
      font-weight: 600;
      letter-spacing: 0.01em;
      white-space: pre-line;
      word-break: keep-all;
      transition: opacity 0.32s cubic-bezier(.4,0,.2,1), transform 0.32s cubic-bezier(.4,0,.2,1);
      opacity: 0;
      pointer-events: none;
      backdrop-filter: blur(8px) saturate(1.2);
      -webkit-backdrop-filter: blur(8px) saturate(1.2);
      line-height: 1.5;
    }
    
    /* Toast type styles */
    #toast.toast-error {
      background: rgba(220, 53, 69, 0.9);
      border-left: 4px solid #dc3545;
    }
    
    #toast.toast-success {
      background: rgba(40, 167, 69, 0.9);
      border-left: 4px solid #28a745;
    }
    
    #toast.toast-warning {
      background: rgba(255, 193, 7, 0.9);
      color: #212529;
      border-left: 4px solid #ffc107;
    }
    #toast.toast-show {
      display: block;
      opacity: 1;
      transform: translate(-50%,-50%) scale(1);
      pointer-events: auto;
    }
    /* 让文件选择行居中 */
    #fileRow {
      width: 100%;
      margin-bottom: 10px;
      display: flex !important;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    /* 上传结果区每行横向布局，标签宽度统一，按钮紧贴input */
    .result .copy-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0;
      margin-bottom: 16px;
      width: 100%;
      flex-wrap: wrap;
    }
    .result .copy-label {
      width: 110px;
      min-width: 90px;
      text-align: right;
      font-size: 1.08rem;
      font-weight: 500;
      color: #222;
      margin-right: 10px;
      white-space: nowrap;
      flex-shrink: 0;
    }
    .result input[type="text"] {
      width: 60%;
      min-width: 0;
      font-size: 0.98rem;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 6px 8px;
      background: #fafbfc;
      margin-right: 0;
      flex: 1 1 120px;
    }
    .result button[type="button"] {
      margin-left: 10px;
      min-width: 70px;
      flex-shrink: 0;
    }
    /* 响应式：移动端100%宽度，自动换行 */
    @media (max-width: 600px) {
      h1 { font-size: 1.5rem; }
      .subtitle { font-size: 1rem; }
      #dropArea { padding: 10vw 2vw; font-size: 1rem; }
      button[type="submit"] { font-size: 1rem; padding: 12px 0; }
      #toast { font-size: 1.01rem; padding: 14px 6vw; min-width: 120px; line-height: 1.7; }
      .header-container { padding: 0 15px; }
      .manage-btn { position: static; transform: none; margin-top: 10px; }
      .result .copy-row {
        flex-direction: column;
        align-items: stretch;
        gap: 6px;
      }
      .result .copy-label {
        text-align: left;
        margin-bottom: 2px;
        margin-right: 0;
        width: 100%;
      }
      .result input[type="text"] {
        width: 100%;
        margin-bottom: 4px;
      }
      .result button[type="button"] {
        width: 100%;
        margin-left: 0;
      }
      #fileRow {
        flex-direction: column;
        align-items: stretch;
        gap: 6px;
      }
      #dropArea {
        width: 95vw !important;
        max-width: 99vw !important;
        margin-left: auto !important;
        margin-right: auto !important;
        border-radius: 10px !important;
        box-sizing: border-box;
      }
    }
    /* CSS优化：结果区每行标签左对齐，input和按钮100%宽度，内容可换行，整体平铺页面不包裹在卡片。下方内容最大宽度放宽，移动端100%宽度。*/
    .result { max-width: 100vw; }
    .result .copy-row { display: flex; align-items: flex-start; justify-content: flex-start; gap: 0; margin-bottom: 16px; width: 100%; flex-wrap: wrap; }
    .result .copy-label { min-width: 120px; max-width: 220px; text-align: left; font-size: 1.08rem; font-weight: 500; color: #222; margin-right: 10px; white-space: pre-line; flex-shrink: 0; word-break: break-all; display: flex; align-items: center; }
    .result input[type="text"] { width: 100%; min-width: 0; font-size: 0.98rem; border: 1px solid #e0e0e0; border-radius: 6px; padding: 6px 8px; background: #fafbfc; margin-right: 0; flex: 1 1 120px; word-break: break-all; }
    .result button[type="button"] { margin-left: 10px; min-width: 70px; flex-shrink: 0; }
    @media (max-width: 900px) {
      .result-flex {
        gap: 20px;
      }
      .result-thumb img {
        max-width: 250px;
        max-height: 250px;
      }
      .result-links {
        width: 90%;
        max-width: 700px;
      }
    }
    @media (max-width: 600px) {
  .upload-container {
    padding: 0 15px;
  }
  .result-flex {
    gap: 16px;
    width: 100%;
    max-width: 100%;
    overflow-x: hidden;
  }
  .result-thumb img {
    max-width: 280px;
    max-height: 280px;
    width: 100%;
    height: auto;
  }
  .result-links {
    width: 100%;
    max-width: 100%;
    text-align: left;
    padding: 0 4px;
    box-sizing: border-box;
    overflow-x: hidden;
  }
  .result-links .copy-row {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
    margin-bottom: 16px;
    justify-content: flex-start;
  }
  .result-links .copy-label {
    width: 100% !important;
    max-width: 100% !important;
    margin-bottom: 8px !important;
    font-size: 1rem !important;
    text-align: center !important;
    justify-content: center !important;
    margin-right: 0 !important;
    display: flex !important;
    align-items: center !important;
  }
  .result-links input[type="text"] {
    width: 100% !important;
    margin-bottom: 8px !important;
    font-size: 0.9rem !important;
    padding: 12px 12px !important;
    min-width: 0 !important;
    max-width: 100% !important;
    word-break: break-all !important;
    white-space: pre-wrap !important;
    box-sizing: border-box !important;
    overflow-x: visible !important;
    height: auto !important;
    min-height: 44px !important;
    border: 1px solid #d0d0d0 !important;
    border-radius: 6px !important;
    background: #f8f9fa !important;
    font-family: 'Courier New', monospace !important;
  }
  .result-links button[type="button"] {
    width: 120px;
    align-self: center;
    font-size: 0.95rem;
    padding: 12px 16px;
    margin-left: 0;
    margin-top: 4px;
    min-width: 0;
    border: 1px solid #007bff;
    border-radius: 6px;
    background: #007bff;
    color: white;
  }
}
    .upload-container {
      max-width: 100%;
      width: 100%;
      margin: 0 auto;
      padding: 0 20px;
      box-sizing: border-box;
    }
    .result {
      width: 100%;
      max-width: 100%;
      margin: 0 auto;
      padding: 0;
      background: transparent;
      border: none;
      box-shadow: none;
    }
    /* CSS优化：图片缩略图居左，宽度固定，链接区最大宽度600px，input和按钮宽度自适应，整体平铺页面。*/
    .result-flex {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 24px;
      width: 100%;
      max-width: 100%;
    }
    .result-thumb {
      text-align: center;
      margin-bottom: 0;
    }
    .result-thumb img {
      max-width: 280px;
      max-height: 280px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      object-fit: contain;
    }

    .result-links {
      width: 66%;
      max-width: 900px;
      min-width: 0;
      margin: 0 auto;
      text-align: left;
    }
    .result-links .copy-row {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 0;
  margin-bottom: 16px;
  width: 100%;
  flex-wrap: nowrap;
}
    .result-links .copy-label {
      text-align: right;
      font-size: 1.08rem;
      font-weight: 500;
      color: #222;
      margin-right: 12px;
      white-space: nowrap;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: flex-end;
    }
    .result-links .copy-label svg,
    .result-links .copy-label img {
      vertical-align: middle;
      margin-right: 6px;
      flex-shrink: 0;
    }
      .result-links .copy-label img {
    position: relative !important;
    top: 6px !important;
  }
  .result-links .copy-label svg,
  .result-links .copy-label img {
    margin-right: 8px;
  }
    .result-links input[type="text"] {
      flex: 1;
      min-width: 400px;
      font-size: 0.95rem;
      border: 1px solid #d0d0d0;
      border-radius: 6px;
      padding: 10px 14px;
      background: #f8f9fa;
      margin-right: 0;
      word-break: break-all;
      overflow-x: auto;
      white-space: nowrap;
      font-family: 'Courier New', monospace;
      color: #333;
    }
    .result-links input[type="text"]:focus {
      outline: none;
      border-color: #007bff;
      background: #fff;
      box-shadow: 0 0 0 2px rgba(0,123,255,0.1);
    }
    .result-links button[type="button"] {
      margin-left: 12px;
      min-width: 70px;
      flex-shrink: 0;
      white-space: nowrap;
    }
    /* Header container for title and manage button */
    .header-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 10px;
      flex-wrap: wrap;
      gap: 15px;
      position: relative;
    }
    .manage-btn {
      background: #28a745;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 500;
      transition: background-color 0.2s;
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      z-index: 1000;
    }
    .manage-btn:hover {
      background: #218838;
    }
    /* Management panel styles */
    .management-panel {
      display: none;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      padding-bottom: 120px;
    }
    .management-panel.show {
      display: block;
    }
    .image-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
      padding-bottom: 60px;
    }
    .image-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      background: #f8f9fa;
    }
    .image-item img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 4px;
    }
    .image-info {
      flex: 1;
    }
    .image-name {
      font-weight: 500;
      margin-bottom: 5px;
    }
    .image-url {
      font-size: 0.9rem;
      color: #666;
      word-break: break-all;
    }
    .image-actions {
      display: flex;
      gap: 10px;
    }
    .delete-btn {
      background: #dc3545;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .delete-btn:hover {
      background: #c82333;
    }
    .copy-btn {
      background: #007bff;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .copy-btn:hover {
      background: #0056b3;
    }
    .back-btn {
      background: #6c757d;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.95rem;
      margin-bottom: 20px;
    }
    .back-btn:hover {
      background: #5a6268;
    }
    
    /* Custom Delete Modal Styles */
    .delete-modal {
      display: none;
      position: fixed;
      z-index: 10000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
    }
    
    .delete-modal-content {
      background-color: #fff;
      margin: 15% auto;
      padding: 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 400px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      animation: modalSlideIn 0.3s ease-out;
    }
    
    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-50px) scale(0.9);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    
    .delete-modal h3 {
      margin: 0 0 15px 0;
      color: #333;
      font-size: 1.3rem;
      font-weight: 600;
    }
    
    .delete-modal p {
      margin: 0 0 25px 0;
      color: #666;
      font-size: 1rem;
      line-height: 1.5;
    }
    
    .delete-modal-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
    }
    
    .delete-confirm-btn {
      background: #dc3545;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      transition: background-color 0.2s;
    }
    
    .delete-confirm-btn:hover {
      background: #c82333;
    }
    
    .delete-cancel-btn {
      background: #6c757d;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      transition: background-color 0.2s;
    }
    
    .delete-cancel-btn:hover {
      background: #5a6268;
    }
    
    /* Responsive design for delete modal */
    @media (max-width: 600px) {
      .delete-modal-content {
        margin: 20% auto;
        padding: 25px 20px;
        width: 85%;
      }
      
      .delete-modal h3 {
        font-size: 1.2rem;
      }
      
      .delete-modal p {
        font-size: 0.95rem;
      }
      
      .delete-modal-buttons {
        flex-direction: column;
        gap: 10px;
      }
      
      .delete-confirm-btn,
      .delete-cancel-btn {
        width: 100%;
        padding: 14px 20px;
      }
    }
    
    /* Mobile optimization for management panel - only for very small screens */
    @media (max-width: 480px) {
      .management-panel {
        padding: 15px 10px;
        max-width: 100%;
        margin: 0;
        padding-bottom: 120px;
      }
      
      .management-panel h2 {
        font-size: 1.5rem;
        margin-bottom: 15px;
      }
      
      .image-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
        padding: 15px;
        margin-bottom: 10px;
      }
      
      .image-item img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        border-radius: 8px;
        align-self: center;
      }
      
      .image-info {
        width: 100%;
      }
      
      .image-name {
        font-size: 1.1rem;
        margin-bottom: 8px;
        word-break: break-all;
      }
      
      .image-url {
        font-size: 0.85rem;
        margin-bottom: 5px;
        word-break: break-all;
        color: #007bff;
      }
      
      .image-info div:last-child {
        font-size: 0.8rem;
        color: #888;
        margin-top: 8px;
      }
      
      .image-actions {
        width: 100%;
        display: flex;
        gap: 10px;
        justify-content: center;
      }
      
      .copy-btn,
      .delete-btn {
        flex: 1;
        padding: 12px 16px;
        font-size: 0.95rem;
        border-radius: 6px;
      }
      
      .back-btn {
        width: 100%;
        margin-bottom: 15px;
        padding: 12px 20px;
        font-size: 1rem;
      }
      .image-list {
        flex-direction: column;
        gap: 15px;
        padding-bottom: 80px;
      }
    }
  </style>
  <style>
    .result {
      max-width: 100vw;
      padding-bottom: 160px;
    }
    @media (max-width: 600px) {
      .result {
        padding-bottom: 200px;
      }
    }
  </style>
  <style>
@media (max-width: 600px) {
  #footerContent {
    padding-top: 88px;
    padding-bottom: 120px;
  }
}
</style>
  <style>
    #backToTopBtn {
      display: none;
      position: fixed;
      right: 28px;
      bottom: 160px;
      z-index: 3000;
      width: 48px;
      height: 48px;
      border: none;
      border-radius: 50%;
      background: #007bff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.13);
      color: #fff;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.2s, opacity 0.3s;
      align-items: center;
      justify-content: center;
      outline: none;
      opacity: 0;
      pointer-events: none;
    }
    #backToTopBtn.show {
      display: flex;
      opacity: 1;
      pointer-events: auto;
      animation: fadeInBtn 0.3s;
    }
    #backToTopBtn:hover {
      background: #0056b3;
      box-shadow: 0 4px 16px rgba(0,86,179,0.18);
    }
    @keyframes fadeInBtn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @media (max-width: 600px) {
      #backToTopBtn {
        width: 48px;
        height: 48px;
        right: 8px;
        bottom: 200px;
      }
      #backToTopBtn svg {
        width: 26px;
        height: 26px;
      }
    }
  </style>
  <style>
    .footer-content-body.faq {
      line-height: 1.4;
      padding-bottom: 80px;
    }
    @media (max-width: 600px) {
      .footer-content-body.faq {
        padding-bottom: 120px;
      }
    }
    .footer-content-body.faq h1,
    .footer-content-body.faq h2 {
      margin-top: 1.1em;
      margin-bottom: 0.5em;
    }
    .footer-content-body.faq p {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
}
</style>
  <style>
    @media (min-width: 601px) {
      .footer-content-body {
        padding-bottom: 80px;
  }
}
</style>
</head>
<body>
  <!-- Header with Logo and Navigation -->
  <header class="main-header">
    <div class="header-content">
      <!-- Logo -->
      <div class="logo">
        <img src="picfast.png" alt="picfast" class="logo-img">
      </div>
      <!-- Navigation -->
      <nav class="main-nav">
        <a href="#" class="nav-link active" id="uploadLink">Upload</a>
        <a href="#" class="nav-link" id="myImagesLink">My Images</a>
        <a href="#" class="nav-link" id="windowsAppLink">Windows App</a>
      </nav>
      <!-- User Actions -->
      <div class="user-actions">
        <a href="#" class="login-btn">Login</a>
        <a href="#" class="signup-btn">Sign Up</a>
      </div>
      <!-- Mobile Menu Button -->
      <button class="mobile-menu-btn" id="mobileMenuBtn">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </header>
  <div class="mobile-menu" id="mobileMenu">
    <div class="mobile-menu-content">
      <a href="#" class="mobile-nav-link active" id="mobileUploadLink">Upload</a>
      <a href="#" class="mobile-nav-link" id="mobileMyImagesLink">My Images</a>
      <a href="#" class="mobile-nav-link" id="mobileWindowsAppLink">Windows App</a>
      <div class="mobile-user-actions">
        <a href="#" class="mobile-login-btn">Login</a>
        <a href="#" class="mobile-signup-btn">Sign Up</a>
      </div>
    </div>
  </div>
  <div class="main-content">
  <!-- Page Title -->
  <div class="page-title">
    <h1>Image Upload & Share</h1>
    <p class="subtitle">Quickly upload images and get shareable links for free.</p>
  </div>
  <div id="dropArea">Drag & drop image here or <span id="dropChoose" style="color:#007bff;text-decoration:underline;cursor:pointer;">choose file</span></div>
        <input type="file" name="image" id="imageInput" accept="image/*" style="display:none;" />
  <div id="fileName" style="display:none;"></div>
  <div id="progressBar" style="display:none;width:96%;height:8px;background:#e3f0ff;border-radius:4px;overflow:hidden;margin:10px auto 0 auto;max-width:420px;">
    <div id="progressInner" style="height:100%;width:0;background:linear-gradient(90deg,#2196f3 0%,#007bff 100%);transition:width 0.2s;"></div>
  </div>
  <div class="result" id="result"></div>
  
  <!-- Management Panel -->
  <div class="management-panel" id="managementPanel">
    <button class="back-btn" id="backBtn">← Back to Upload</button>
    <h2>Manage Images</h2>
    <div class="image-list-controls" id="imageListControls" style="display:flex;align-items:center;gap:16px;margin-bottom:18px;justify-content:flex-start;">
      <button id="selectAllBtn" type="button">Select All</button>
      <button id="deleteSelectedBtn" type="button" disabled>Delete Selected</button>
    </div>
    <div class="image-list" id="imageList">
      <!-- Images will be loaded here -->
    </div>
  </div>
  
  <div id="toast"></div>
  
  <!-- Custom Delete Confirmation Modal -->
  <div id="deleteModal" class="delete-modal">
    <div class="delete-modal-content">
      <h3>Confirm Deletion</h3>
      <p>Are you sure you want to delete this image?</p>
      <div class="delete-modal-buttons">
        <button id="deleteConfirmBtn" class="delete-confirm-btn">Confirm</button>
        <button id="deleteCancelBtn" class="delete-cancel-btn">Cancel</button>
      </div>
    </div>
  </div>
  
  <!-- End flat layout -->
  </div>
  <div id="footerContent" style="display:none;"></div>
  <footer class="site-footer">
    <div class="footer-links">
      <div class="footer-nav">
        <a href="#" class="footer-link">Upload</a>
        <a href="#" class="footer-link">Upload by URL</a>
        <a href="#" class="footer-link">Website plugins</a>
        <a href="#" class="footer-link">Windows App</a>
      </div>
      <div class="footer-help">
        <a href="#" class="footer-link">About</a>
        <a href="#" class="footer-link">Terms of Use</a>
        <a href="#" class="footer-link">Privacy Policy</a>
        <a href="#" class="footer-link">FAQ</a>
        <a href="#" class="footer-link">Contact us</a>
        <a href="#" class="footer-link" id="footerLanguages">Languages</a>
      </div>
    </div>
    <div class="footer-copyright">
      Powered by <b>Picfast</b> &copy; <span id="footerYear"></span>
    </div>
  </footer>

  <style>
    .site-footer {
      width: 100%;
      background: #fff;
      border-top: 1px solid #e1e5e9;
      margin-top: 48px;
      padding: 28px 0 16px 0;
      font-size: 1rem;
      color: #666;
      text-align: center;
      position: fixed;
      left: 0;
      bottom: 0;
      z-index: 100;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.03);
    }
    .footer-links {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 32px;
      margin-bottom: 10px;
    }
    .footer-nav, .footer-help {
      display: flex;
      flex-wrap: wrap;
      gap: 18px;
      justify-content: center;
    }
    .footer-link {
      color: #1976d2;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s;
      font-size: 1rem;
    }
    .footer-link:hover {
      color: #0d47a1;
      text-decoration: underline;
    }
    .footer-copyright {
      margin-top: 10px;
      color: #888;
      font-size: 0.98rem;
    }
    @media (max-width: 700px) {
      .footer-links {
        flex-direction: column;
        gap: 12px;
      }
      .footer-nav, .footer-help {
        gap: 10px;
      }
    }
    @media (max-width: 480px) {
      .site-footer {
        font-size: 0.98rem;
        padding: 18px 0 10px 0;
        position: fixed;
        left: 0;
        bottom: 0;
        z-index: 100;
      }
      .footer-link {
        font-size: 0.97rem;
      }
    }
  </style>
  
  <script>
    const result = document.getElementById('result');
    // Auto upload logic
    function uploadImage(file) {
      console.log('Upload started for file:', file.name);
      if (!file) return;
      
      // File size check (5MB = 5 * 1024 * 1024 bytes)
      const maxSize = 5 * 1024 * 1024; // 5MB in bytes
      if (file.size > maxSize) {
        showToast('File size too large! Maximum size is 5MB.');
        return;
      }
      
      const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp', 'image/heic', 'image/heif'];
      const isHeicExt = /\.heic$/i.test(file.name) || /\.heif$/i.test(file.name);
      if ((file.type && !allowedTypes.includes(file.type)) && !isHeicExt) {
        showToast('Only jpg, jpeg, png, gif, webp, heic formats are supported!');
        return;
      }
      if (file.type === 'image/heic' || file.type === 'image/heif' || isHeicExt) {
        showToast('HEIC will be converted to JPG for preview.');
      }
      const formData = new FormData();
      formData.append('image', file);
      // 新增：带上visitor_id
      formData.append('visitor_id', getVisitorId());
      result.textContent = 'Uploading...';
      result.classList.remove('show');
        const xhr = new XMLHttpRequest();
        xhr.open('POST', '/upload');
        xhr.upload.onprogress = function(e) {
          if (e.lengthComputable) {
            const percent = Math.round((e.loaded / e.total) * 100);
            showProgress(percent);
        } else {
          // If progress cannot be calculated, at least show progress bar
          showProgress(10);
          }
        };
        xhr.onload = function() {
          hideProgress();
          let data = {};
          try { data = JSON.parse(xhr.responseText); } catch {}
          
          // Handle rate limit errors specifically
          if (xhr.status === 429) {
            let message = data.error || 'Rate limit exceeded';
            if (data.blockedUntil) {
              const remainingTime = Math.ceil((data.blockedUntil - Date.now()) / 1000 / 60);
              message = `Rate limit exceeded. Please try again in ${remainingTime} minutes.`;
            }
            showToast(message, 'error');
            result.classList.remove('show');
            result.style.display = 'block';
            result.textContent = message;
            return;
          }
          
          if (data.url) {
          const filename = (fileInput.files[0] && fileInput.files[0].name) || 'image';
          // Use dynamic domain, support deployment
          const baseUrl = window.location.origin;
          const pageLink = `${baseUrl}/img/${data.url.split('/').pop()}`;
          const imageLink = `${baseUrl}${data.imageLink}`;  // 使用后端返回的完整图片链接
          // Two Markdown formats matching postimg
          const markdownReddit = `[${filename}](${pageLink})`;
          const markdownGithub = `[![${filename}](${imageLink})](${pageLink})`;
          // Thumbnail format: use thumbnail link
          const forumThumb = `[url=${pageLink}][img]${pageLink}[/img][/url]`;
          const websiteThumb = `<a href='${pageLink}' target='_blank'><img src='${pageLink}' alt='${filename}' /></a>`;
          // Hotlink format: use direct image link
          const forumHotlink = `[url=${pageLink}][img]${imageLink}[/img][/url]`;
          const websiteHotlink = `<a href='${pageLink}' target='_blank'><img src='${imageLink}' alt='${filename}' /></a>`;
          const removalLink = `${baseUrl}/delete/${data.url.split('/').pop()}`;
                                  // SVG icons
            const redditIcon = `<svg width='24' height='24' viewBox='0 0 24 24' style='vertical-align:middle;margin-right:4px;'><path d='M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z' fill='#FF4500'/></svg>`;
            const githubIcon = `<svg width='24' height='24' viewBox='0 0 20 20' style='vertical-align:middle;margin-right:4px;'><g><circle cx='10' cy='10' r='10' fill='#fff'/><path d='M10 2C5.58 2 2 5.58 2 10c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.01.08-2.1 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.09.16 1.9.08 2.1.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.19 0 .21.15.46.55.38A8.013 8.013 0 0 0 18 10c0-4.42-3.58-8-8-8z' fill='#181717'/><rect x='13' y='13' width='5' height='2' rx='1' fill='#f48024'/></g></svg>`;
          // Escape special characters in HTML strings
          const escapedWebsiteThumb = websiteThumb.replace(/'/g, "\\'").replace(/"/g, '\\"');
          const escapedWebsiteHotlink = websiteHotlink.replace(/'/g, "\\'").replace(/"/g, '\\"');
          result.innerHTML = `
            <div class="result-flex">
              <div class="result-thumb">
                <img src="${data.url}" alt="Image" />
              </div>
              <div class="result-links">
                <div style="margin-bottom:18px;font-weight:bold;font-size:1.18rem;text-align:center;">Upload successful!</div>
                <div class="copy-row"><span class="copy-label">Link:</span><input type="text" value="${pageLink}" readonly /><button type="button" onclick="copyToClipboard('${pageLink}', this)">Copy</button></div>
                <div class="copy-row"><span class="copy-label">Direct link:</span><input type="text" value="${imageLink}" readonly /><button type="button" onclick="copyToClipboard('${imageLink}', this)">Copy</button></div>
                <div class="copy-row"><span class="copy-label">${redditIcon}Markdown:</span><input type="text" value="${markdownReddit}" readonly /><button type="button" onclick="copyToClipboard('${markdownReddit}', this)">Copy</button></div>
                <div class="copy-row"><span class="copy-label">${githubIcon}Markdown:</span><input type="text" value="${markdownGithub}" readonly /><button type="button" onclick="copyToClipboard('${markdownGithub}', this)">Copy</button></div>
                <div class="copy-row"><span class="copy-label">Thumbnail for forums:</span><input type="text" value="${forumThumb}" readonly /><button type="button" onclick="copyToClipboard('${forumThumb}', this)">Copy</button></div>
                <div class="copy-row"><span class="copy-label">Thumbnail for website:</span><input type="text" value="${websiteThumb}" readonly /><button type="button" onclick="copyToClipboard('${escapedWebsiteThumb}', this)">Copy</button></div>
                <div class="copy-row"><span class="copy-label">Hotlink for forums:</span><input type="text" value="${forumHotlink}" readonly /><button type="button" onclick="copyToClipboard('${forumHotlink}', this)">Copy</button></div>
                <div class="copy-row"><span class="copy-label">Hotlink for website:</span><input type="text" value="${websiteHotlink}" readonly /><button type="button" onclick="copyToClipboard('${escapedWebsiteHotlink}', this)">Copy</button></div>
                <div class="copy-row"><span class="copy-label">Removal link:</span><input type="text" value="${removalLink}" readonly /><button type="button" onclick="copyToClipboard('${removalLink}', this)">Copy</button></div>
                <div style="margin-bottom:8px;text-align:center;"><a href="${data.url}" target="_blank">View Image</a></div>
              </div>
            </div>
          `;
          result.classList.add('show');
          result.style.display = 'block';
          console.log('Upload successful, result displayed');
          } else {
          result.classList.remove('show');
          result.style.display = 'block';
            result.textContent = data.error || 'Upload failed';
          }
        };
        xhr.onerror = function() {
          hideProgress();
        result.classList.remove('show');
        result.style.display = 'block';
          result.textContent = 'Upload failed, please try again';
        };
        xhr.send(formData);
      }
    // Drag and drop upload functionality
    // Ensure fileInput2 and fileInput both point to the input element with id imageInput
    const fileInput = document.getElementById('imageInput');
    const fileInput2 = fileInput;
    const fileNameSpan = document.getElementById('fileName');
    const dropArea = document.getElementById('dropArea');
    const dropChoose = document.getElementById('dropChoose');
    dropArea.addEventListener('click', () => fileInput.click());
    dropChoose.addEventListener('click', e => { e.stopPropagation(); fileInput.click(); });
    fileInput.addEventListener('change', () => {
      if (fileInput.files.length) {
        fileNameSpan.textContent = fileInput.files[0].name;
        uploadImage(fileInput.files[0]);
      } else {
        fileNameSpan.textContent = '';
      }
    });
    ['dragenter','dragover'].forEach(evt => dropArea.addEventListener(evt, e => {
      e.preventDefault(); e.stopPropagation(); dropArea.classList.add('dragover');
    }));
    ['dragleave','drop'].forEach(evt => dropArea.addEventListener(evt, e => {
      e.preventDefault(); e.stopPropagation(); dropArea.classList.remove('dragover');
    }));
    dropArea.addEventListener('drop', e => {
      if (e.dataTransfer.files && e.dataTransfer.files.length) {
        fileInput.files = e.dataTransfer.files;
        fileNameSpan.textContent = fileInput.files[0].name;
        uploadImage(fileInput.files[0]);
      }
    });
    // Custom file selection button logic - remove references to non-existent elements

    // Management panel functionality
    const manageBtn = document.getElementById('manageBtn');
    const backBtn = document.getElementById('backBtn');
    const managementPanel = document.getElementById('managementPanel');
    const imageList = document.getElementById('imageList');
    const progressBar = document.getElementById('progressBar');

    // Show management panel
    function showManagementPanel() {
      // Hide main content
      document.getElementById('dropArea').style.display = 'none';
      progressBar.style.display = 'none';
      document.getElementById('result').style.display = 'none';
      document.querySelector('.page-title').style.display = 'none';
      document.querySelector('#fileName').style.display = 'none';
      document.querySelector('#imageInput').style.display = 'none';
      
      // Show management panel
      managementPanel.classList.add('show');
      loadImageList();
      
      // Update navigation
      document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
      document.querySelectorAll('.mobile-nav-link').forEach(link => link.classList.remove('active'));
      document.getElementById('myImagesLink').classList.add('active');
      document.getElementById('mobileMyImagesLink').classList.add('active');
    }

    // Hide management panel
    function hideManagementPanel() {
      // Show main content
      document.getElementById('dropArea').style.display = '';
      document.querySelector('.page-title').style.display = '';
      document.querySelector('#imageInput').style.display = 'none'; // Keep hidden as it should be
      
      // Reset upload state - but keep result content if it exists
      progressBar.style.display = 'none';
      document.getElementById('progressInner').style.width = '0';
      document.getElementById('fileName').style.display = 'none';
      document.getElementById('fileName').textContent = '';
      
      // Clear file input
      document.getElementById('imageInput').value = '';
      
      // Hide management panel
      managementPanel.classList.remove('show');
      
      // Update navigation
      document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
      document.querySelectorAll('.mobile-nav-link').forEach(link => link.classList.remove('active'));
      document.getElementById('uploadLink').classList.add('active');
      document.getElementById('mobileUploadLink').classList.add('active');
    }

    // Load image list
    async function loadImageList() {
      try {
        // 新增：带上visitor_id参数
        const visitorId = getVisitorId();
        const response = await fetch('/api/images?visitor_id=' + encodeURIComponent(visitorId));
        const images = await response.json();
        
        if (images.length === 0) {
          imageList.innerHTML = '<p style="text-align:center;color:#666;margin:20px;">No images uploaded yet.</p>';
        return;
        }

        // Sort images by upload time, newest first
        const sortedImages = images.sort((a, b) => new Date(b.uploadTime) - new Date(a.uploadTime));

        imageList.innerHTML = sortedImages.map(image => `
          <div class="image-item">
            <input type="checkbox" class="image-checkbox" data-id="${image.id}" style="margin-right:12px;transform:scale(1.2);">
            <img src="${image.directUrl}" alt="${image.originalName}" onerror="this.style.display='none'">
            <div class="image-info">
              <div class="image-name">${image.originalName}</div>
              <div class="image-url">${window.location.origin}${image.url}</div>
              <div style="font-size:0.8rem;color:#888;margin-top:5px;">
                Uploaded: ${new Date(image.uploadTime).toLocaleString()}
              </div>
            </div>
            <div class="image-actions">
              <button class="copy-btn" onclick="copyToClipboard('${window.location.origin}${image.url}', this)">Copy Link</button>
              <button class="delete-btn" onclick="deleteImage('${image.id}', this)">Delete</button>
            </div>
          </div>
        `).join('');
      } catch (error) {
        console.error('Error loading images:', error);
        imageList.innerHTML = '<p style="text-align:center;color:#dc3545;margin:20px;">Error loading images.</p>';
      }
    }

    // Delete image
    async function deleteImage(id, button) {
      const deleteModal = document.getElementById('deleteModal');
      const confirmBtn = document.getElementById('deleteConfirmBtn');
      const cancelBtn = document.getElementById('deleteCancelBtn');
      // 重置弹窗内容为单张删除
      deleteModal.querySelector('h3').textContent = 'Confirm Deletion';
      deleteModal.querySelector('p').textContent = 'Are you sure you want to delete this image?';
      deleteModal.style.display = 'block';
      
      // Handle confirm
      const handleConfirm = async () => {
        deleteModal.style.display = 'none';
        button.disabled = true;
        button.textContent = 'Deleting...';

        try {
          const response = await fetch(`/delete/${id}`, { method: 'DELETE' });
          const result = await response.json();

          if (result.success) {
            button.closest('.image-item').remove();
            showToast('Image deleted successfully');
            
            // If no images left, show empty message
            if (imageList.children.length === 0) {
              imageList.innerHTML = '<p style="text-align:center;color:#666;margin:20px;">No images uploaded yet.</p>';
            }
          } else {
            showToast('Failed to delete image');
            button.disabled = false;
            button.textContent = 'Delete';
          }
        } catch (error) {
          console.error('Error deleting image:', error);
          showToast('Error deleting image');
          button.disabled = false;
          button.textContent = 'Delete';
        }
      };
      
      // Handle cancel
      const handleCancel = () => {
        deleteModal.style.display = 'none';
      };
      
      // Add event listeners
      confirmBtn.onclick = handleConfirm;
      cancelBtn.onclick = handleCancel;
      
      // Close modal when clicking outside
      deleteModal.onclick = (e) => {
        if (e.target === deleteModal) {
          handleCancel();
        }
      };
      
      // Close modal with Escape key
      const handleEscape = (e) => {
        if (e.key === 'Escape') {
          handleCancel();
          document.removeEventListener('keydown', handleEscape);
        }
      };
      document.addEventListener('keydown', handleEscape);
    }

    // Event listeners for management panel
    if (manageBtn) {
      manageBtn.addEventListener('click', () => {
        console.log('Manage button clicked');
        showManagementPanel();
      });
    }
    
    if (backBtn) {
      backBtn.addEventListener('click', () => {
        console.log('Back button clicked');
        hideManagementPanel();
      });
    }



    // Copy to clipboard and show toast
    function copyToClipboard(text, btn) {
      navigator.clipboard.writeText(text).then(() => {
        const old = btn.textContent;
        btn.textContent = 'Copied!';
        btn.disabled = true;
        setTimeout(() => {
          btn.textContent = old;
          btn.disabled = false;
        }, 1200);
      });
    }

    function showProgress(percent) {
      const bar = document.getElementById('progressBar');
      const inner = document.getElementById('progressInner');
      bar.style.display = 'block';
      inner.style.width = percent + '%';
    }
    function hideProgress() {
      const bar = document.getElementById('progressBar');
      const inner = document.getElementById('progressInner');
      inner.style.width = '0';
      setTimeout(() => { bar.style.display = 'none'; }, 400);
    }

    // Toast popup
    function showToast(msg, type = 'info') {
      const toast = document.getElementById('toast');
      toast.textContent = msg;
      
      // Remove existing type classes
      toast.classList.remove('toast-error', 'toast-success', 'toast-warning');
      
      // Add type-specific class
      if (type === 'error') {
        toast.classList.add('toast-error');
      } else if (type === 'success') {
        toast.classList.add('toast-success');
      } else if (type === 'warning') {
        toast.classList.add('toast-warning');
      }
      
      toast.classList.add('toast-show');
      setTimeout(() => { toast.classList.remove('toast-show'); }, 3000);
    }

    // Initialize page state
    function initializePage() {
      // Reset upload state
      progressBar.style.display = 'none';
      document.getElementById('progressInner').style.width = '0';
      document.getElementById('fileName').style.display = 'none';
      document.getElementById('fileName').textContent = '';
      document.getElementById('imageInput').value = '';
    }

    // Navigation functionality
    function hideFooterContentIfShown() {
      const footerContent = document.getElementById('footerContent');
      if (footerContent && footerContent.style.display === 'block') {
        footerContent.style.display = 'none';
        document.querySelector('.main-content').style.display = '';
      }
    }
    // --- SPA友好URL美化（不影响功能）---
    function updateUrl(path) {
      if (window.location.pathname !== path) {
        window.history.pushState({}, '', path);
      }
    }
    // 主导航
    document.getElementById('uploadLink').addEventListener('click', function(e) {
      e.preventDefault();
      hideFooterContentIfShown();
      showUploadPage();
      updateUrl('/');
    });
    document.getElementById('myImagesLink').addEventListener('click', function(e) {
      e.preventDefault();
      hideFooterContentIfShown();
      showManagementPanel();
      updateUrl('/my-images');
    });
    document.getElementById('windowsAppLink').addEventListener('click', function(e) {
      e.preventDefault();
      hideFooterContentIfShown();
      showToast('Windows App coming soon!');
      updateUrl('/windows-app');
    });
    // 移动端主导航
    document.getElementById('mobileUploadLink').addEventListener('click', function(e) {
      e.preventDefault();
      hideFooterContentIfShown();
      showUploadPage();
      updateUrl('/');
      closeMobileMenu();
    });
    document.getElementById('mobileMyImagesLink').addEventListener('click', function(e) {
      e.preventDefault();
      hideFooterContentIfShown();
      showManagementPanel();
      updateUrl('/my-images');
      closeMobileMenu();
    });
    document.getElementById('mobileWindowsAppLink').addEventListener('click', function(e) {
      e.preventDefault();
      hideFooterContentIfShown();
      showToast('Windows App coming soon!');
      updateUrl('/windows-app');
      closeMobileMenu();
    });
    // Footer导航
    document.querySelectorAll('.footer-link').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const txt = link.textContent.trim();
        if (txt === 'Upload') {
          updateUrl('/');
        } else if (txt === 'About') updateUrl('/about');
        else if (txt === 'Terms of Use') updateUrl('/terms');
        else if (txt === 'Privacy Policy') updateUrl('/privacy');
        else if (txt === 'FAQ') updateUrl('/faq');
        else if (txt === 'Contact us') updateUrl('/contact');
        else if (txt === 'Languages') updateUrl('/languages');
        else if (txt === 'Upload by URL') updateUrl('/upload-by-url');
        else if (txt === 'Website plugins') updateUrl('/website-plugins');
      });
    });
    
    // Logo点击回首页并美化URL
    document.querySelector('.logo-img').addEventListener('click', function() {
      hideFooterContentIfShown();
      showUploadPage();
      if (window.location.pathname !== '/') {
        window.history.pushState({}, '', '/');
      }
    });
    
    // Mobile menu functionality
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    
    mobileMenuBtn.addEventListener('click', function() {
      mobileMenu.classList.toggle('show');
      
      // Animate hamburger menu
      const spans = this.querySelectorAll('span');
      if (mobileMenu.classList.contains('show')) {
        spans[0].style.transform = 'rotate(45deg) translate(5px, 5px)';
        spans[1].style.opacity = '0';
        spans[2].style.transform = 'rotate(-45deg) translate(7px, -6px)';
      } else {
        spans[0].style.transform = 'none';
        spans[1].style.opacity = '1';
        spans[2].style.transform = 'none';
      }
    });
    
    // Close mobile menu function
    function closeMobileMenu() {
      mobileMenu.classList.remove('show');
      const spans = mobileMenuBtn.querySelectorAll('span');
      spans[0].style.transform = 'none';
      spans[1].style.opacity = '1';
      spans[2].style.transform = 'none';
    }
    
    // Close mobile menu when clicking outside
    document.addEventListener('click', function(e) {
      if (!mobileMenuBtn.contains(e.target) && !mobileMenu.contains(e.target)) {
        closeMobileMenu();
      }
    });
    
    // Show upload page function
    function showUploadPage() {
      // Hide management panel if visible
      document.getElementById('managementPanel').classList.remove('show');
      
      // Show main content
      document.getElementById('dropArea').style.display = '';
      document.querySelector('.page-title').style.display = '';
      document.querySelector('#imageInput').style.display = 'none';
      
      // Reset upload state
      progressBar.style.display = 'none';
      document.getElementById('progressInner').style.width = '0';
      document.getElementById('fileName').style.display = 'none';
      document.getElementById('fileName').textContent = '';
      document.getElementById('imageInput').value = '';
      
      // Update navigation
      document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
      document.querySelectorAll('.mobile-nav-link').forEach(link => link.classList.remove('active'));
      document.getElementById('uploadLink').classList.add('active');
      document.getElementById('mobileUploadLink').classList.add('active');
    }
    
    // Initialize page on load
    window.onload = initializePage;

    function copyHtmlToClipboard(btn) {
      const input = btn.previousElementSibling;
      const html = input.value.replace(/&quot;/g, '"').replace(/&lt;/g, '<').replace(/&gt;/g, '>');
      navigator.clipboard.writeText(html).then(() => {
        const old = btn.textContent;
        btn.textContent = 'Copied!';
        btn.disabled = true;
        setTimeout(() => {
          btn.textContent = old;
          btn.disabled = false;
        }, 1200);
      });
    }

    // 页脚年份自动更新，确保在DOM渲染后执行
    window.addEventListener('DOMContentLoaded', function() {
      var yearSpan = document.getElementById('footerYear');
      if (yearSpan) yearSpan.textContent = new Date().getFullYear();
    });

    // 页脚导航点击事件（可后续扩展）
    document.querySelectorAll('.footer-link').forEach(link => {
      link.addEventListener('click', function(e) {
        const helpTitles = ['About', 'Terms of Use', 'Privacy Policy', 'FAQ', 'Contact us'];
        if (helpTitles.includes(this.textContent)) {
          e.preventDefault();
          showFooterContent(this.textContent);
        } else if (this.textContent === 'Upload') {
          e.preventDefault();
          hideFooterContentIfShown();
          showUploadPage();
        } else if (this.textContent === 'Windows App') {
          e.preventDefault();
          hideFooterContentIfShown();
          showToast('Windows App coming soon!', 'info');
        } else if (this.textContent === 'Upload by URL' || this.textContent === 'Website plugins') {
          e.preventDefault();
          hideFooterContentIfShown();
          showToast('Feature coming soon!', 'info');
        }
      });
    });

    // 显示footer内容区
    function showFooterContent(type) {
      // 隐藏主内容
      document.querySelector('.main-content').style.display = 'none';
      if (document.getElementById('managementPanel')) document.getElementById('managementPanel').classList.remove('show');
      // 填充内容
      const content = {
        'About': `
          <h1>About Picfast</h1>
          <div class="footer-content-body">
            <p><strong>Picfast</strong> is a free, fast, and reliable <b>image upload</b> and <b>image hosting</b> service. Instantly upload your pictures and get shareable links for forums, blogs, social media, and more. No registration required. Our mission is to make <b>image sharing</b> and <b>hotlinking</b> easy and accessible for everyone.</p>
            <h2>Why Choose Us?</h2>
            <ul>
              <li>Unlimited free image uploads</li>
              <li>Direct links for sharing and embedding</li>
              <li>Fast and stable global CDN delivery</li>
              <li>Supports JPG, PNG, GIF, WebP, HEIC and more</li>
              <li>No registration required</li>
              <li>Perfect for forums, blogs, eBay, Reddit, and more</li>
            </ul>
            <p>Join thousands of users who trust Picfast for <b>free image hosting</b> and <b>photo sharing</b> every day.</p>
          </div>
        `,
        'Terms of Use': `
          <div class="footer-content-body">
            <h1>Terms of Use</h1>
            <article>
              <h2>1. Acceptable Use</h2>
              <ul>
                <li><b>You may only upload images that you own or have the legal right to share.</b></li>
                <li>Do not upload images that are illegal, infringe copyright, contain hate speech, violence, harassment, or any content that is offensive or prohibited by law.</li>
                <li>Images that violate these terms will be removed without notice, and repeat offenders may be banned.</li>
            </ul>
            </article>
            <article>
              <h2>2. Prohibited Content</h2>
              <ul>
                <li>Copyrighted images without permission.</li>
                <li>Images containing violence, hate speech, threats, harassment, or defamation.</li>
                <li>Images that promote illegal activity or violate any applicable law.</li>
                <li>Pornographic, sexually explicit, or adult content.</li>
                <li>Images that may be illegal in your country or region.</li>
              </ul>
            </article>
            <article>
              <h2>3. Image Hosting and Hotlinking</h2>
              <ul>
                <li>Picfast is designed for sharing images on forums, blogs, social media, and websites.</li>
                <li>When embedding images on third-party sites, please link back to the original Picfast page when possible.</li>
                <li>Automated or programmatic uploads (bots, scripts, etc.) are not allowed. For large-scale or commercial image hosting, please use dedicated cloud storage services.</li>
              </ul>
            </article>
            <article>
              <h2>4. User Responsibility</h2>
              <ul>
                <li>You are responsible for all content you upload. By uploading, you confirm you have the rights to share the image and that it does not violate any laws or third-party rights.</li>
                <li>Picfast is not responsible for user-uploaded content. All images are accessible via a unique URL; please share responsibly.</li>
              </ul>
            </article>
            <article>
              <h2>5. Copyright and DMCA</h2>
              <ul>
                <li>If you believe your copyright has been infringed, please contact us with the following:</li>
                <ul>
                  <li>Identification of the copyrighted work.</li>
                  <li>The URL of the infringing image.</li>
                  <li>Your contact information and a statement of good faith.</li>
                </ul>
                <li>We will promptly investigate and remove infringing content as required by law.</li>
              </ul>
            </article>
            <article>
              <h2>6. Data Retention and Removal</h2>
              <ul>
                <li>Images are stored indefinitely unless deleted by the uploader or if they violate these terms.</li>
                <li>You can delete your images using the removal link provided after upload or by contacting support.</li>
              </ul>
            </article>
            <article>
              <h2>7. Service Availability</h2>
              <ul>
                <li>Picfast is provided "as is" and "as available." We do not guarantee continuous service or permanent storage of images.</li>
                <li>We reserve the right to remove any content or discontinue the service at any time without notice.</li>
              </ul>
            </article>
            <article>
              <h2>8. Limitation of Liability</h2>
              <ul>
                <li>Picfast is not liable for any loss, damage, or claims arising from the use or inability to use our service, including loss of images or data.</li>
              </ul>
            </article>
            <article>
              <h2>9. Indemnification</h2>
              <ul>
                <li>By using Picfast, you agree to indemnify and hold harmless Picfast and its team from any claims, damages, or liabilities arising from your use of the service or violation of these terms.</li>
              </ul>
            </article>
            <article>
              <h2>10. Changes to These Terms</h2>
              <ul>
                <li>We may update these Terms of Use at any time. Continued use of Picfast after changes means you accept the updated terms.</li>
              </ul>
            </article>
            <article>
              <h2>11. Contact</h2>
              <ul>
                <li>For questions, support, or copyright issues, please contact us at [your support email].</li>
              </ul>
            </article>
          </div>
        `,
        'Privacy Policy': `
          <div class="footer-content-body">
            <h1>Privacy Policy</h1>
            <p>At Picfast, we are committed to protecting your privacy and ensuring a safe online experience. This Privacy Policy explains how we collect, use, and protect your information when you use our free image hosting service.</p>
            <article>
              <h2>What Information Do We Collect?</h2>
              <ul>
                <li><b>Anonymous Uploads:</b> You do not need to register or provide any personal information to upload images. We do not collect your name, email, or any other personally identifiable information for anonymous uploads.</li>
                <li><b>Contact Information:</b> If you contact us for support or feedback, we may collect your email address and any information you provide in your message.</li>
                <li><b>Technical Data:</b> We automatically collect non-personal information such as your IP address, browser type, device information, and usage statistics to help us improve our service and ensure security.</li>
            </ul>
            </article>
            <article>
              <h2>How Do We Use Your Information?</h2>
              <ul>
                <li>To provide and improve our image hosting service.</li>
                <li>To respond to your support requests or feedback.</li>
                <li>To analyze site usage and enhance user experience.</li>
                <li>To protect our service from abuse and ensure security.</li>
              </ul>
            </article>
            <article>
              <h2>How Do We Protect Your Information?</h2>
              <ul>
                <li>We use industry-standard security measures to protect our servers and your data.</li>
                <li>All access to our systems is restricted to authorized personnel only.</li>
                <li>We do not store sensitive personal information or payment data.</li>
              </ul>
            </article>
            <article>
              <h2>Cookies and Tracking Technologies</h2>
              <ul>
                <li>We use cookies to remember your preferences and improve your experience.</li>
                <li>Cookies help us analyze site traffic and usage patterns.</li>
                <li>You can disable cookies in your browser settings, but some features may not work as intended.</li>
              </ul>
            </article>
            <article>
              <h2>Third-Party Services</h2>
              <ul>
                <li>We may use trusted third-party analytics and advertising services (such as Google Analytics) to help us understand site usage and display relevant ads.</li>
                <li>These third parties may use cookies or similar technologies to collect non-personal information about your visits to our site and other websites.</li>
              </ul>
            </article>
            <article>
              <h2>Image Privacy and Public Access</h2>
              <ul>
                <li>All images uploaded to Picfast are accessible via a unique URL. Anyone with the link can view the image.</li>
                <li>We do not list or index your images publicly, but images are not password-protected or hidden from anyone with the link.</li>
                <li>Please do not upload sensitive or private images if you do not want them to be accessible to others.</li>
              </ul>
            </article>
            <article>
              <h2>Data Retention and Deletion</h2>
              <ul>
                <li>Images are stored indefinitely unless deleted by the uploader or if they violate our Terms of Use.</li>
                <li>If you wish to delete an image, use the removal link provided after upload or contact us for assistance.</li>
                <li>If you have contacted us and wish to have your support data deleted, please email us at [your support email] and we will process your request promptly.</li>
              </ul>
            </article>
            <article>
              <h2>Children's Privacy</h2>
              <ul>
                <li>Picfast is not intended for use by children under 13. We do not knowingly collect personal information from children.</li>
              </ul>
            </article>
            <article>
              <h2>Changes to This Privacy Policy</h2>
              <ul>
                <li>We may update this Privacy Policy from time to time. Changes will be posted on this page with an updated effective date.</li>
                <li>Continued use of Picfast after changes means you accept the updated policy.</li>
              </ul>
            </article>
            <article>
              <h2>Contact Us</h2>
              <ul>
                <li>If you have any questions or concerns about this Privacy Policy or your data, please contact us at [your support email].</li>
              </ul>
            </article>
          </div>
        `,
        'FAQ': `
          <div class="footer-content-body faq">
            <h1>Frequently Asked Questions</h1>
            <p>If you're stumped and need a little help, you're on the right page. You'll probably be able to find the answer to your questions right here. If you have a question that is not listed please feel free to <a href="javascript:void(0)" class="footer-link" data-footer-link="Contact us">contact us</a>.</p>
            <article>
              <h2>What is Picfast?</h2>
              <p>Picfast is a free, fast, and reliable image hosting service. Instantly upload images and get shareable links for forums, blogs, social media, and more—no registration required.</p>
            </article>
            <article>
              <h2>How do I upload images?</h2>
              <p>Click the "Upload" button on the homepage, select your images, and they will be uploaded instantly. You'll receive a variety of shareable links and embed codes for each image.</p>
            </article>
            <article>
              <h2>What image formats are supported?</h2>
              <p>Picfast supports JPG, PNG, GIF, WebP, and HEIC formats.</p>
            </article>
            <article>
              <h2>What is the maximum allowed file size?</h2>
              <p>Each image can be up to 5MB in size. There is no limit on the number of images you can upload.</p>
            </article>
            <article>
              <h2>How do I share images on forums, eBay, or websites?</h2>
              <p>After uploading, you'll see several link options:</p>
              <ul>
                <li><b>Direct link</b>: Use for sharing the image directly.</li>
                <li><b>Markdown/BBCode</b>: For forums and markdown editors.</li>
                <li><b>Thumbnail/Hotlink</b>: For embedding in websites or forums.</li>
              </ul>
              <p>Simply click "Copy" next to the desired link and paste it where you need.</p>
            </article>
            <article>
              <h2>Can I manage or delete my uploaded images?</h2>
              <p>Yes! Click "My Images" in the navigation to view, copy, or delete your uploaded images. You can select multiple images for batch deletion.</p>
            </article>
            <article>
              <h2>How long will my images be stored?</h2>
              <p>Images are stored indefinitely as long as they comply with our Terms of Use. We do not remove images due to inactivity.</p>
            </article>
            <article>
              <h2>Are my images private?</h2>
              <p>Your images are not listed publicly. Only people with the direct link can view them. However, anyone with the link can access the image, so please share responsibly.</p>
            </article>
            <article>
              <h2>Can I upload images anonymously?</h2>
              <p>Yes, you do not need to register to use Picfast. All uploads are anonymous by default.</p>
            </article>
            <article>
              <h2>I deleted an image, but the link still works. Why?</h2>
              <p>Deleted images may remain accessible for a short time due to caching. Usually, the image will be fully removed from our servers and CDN within 30 minutes.</p>
            </article>
            <article>
              <h2>Can I replace an image and keep the same URL?</h2>
              <p>Currently, replacing an image while keeping the same URL is not supported. Please upload the new image and use the new link.</p>
            </article>
            <article>
              <h2>Is there a limit to how many images I can upload at once?</h2>
              <p>You can select and upload multiple images in a single batch, up to your browser's file selection limit and the 5MB per image size limit.</p>
            </article>
            <article>
              <h2>Do you support hotlinking?</h2>
              <p>Yes! You can use the direct link or hotlink code to embed your images on other websites, forums, or social media.</p>
            </article>
            <article>
              <h2>What should I do if I have a problem or question not listed here?</h2>
              <p>Please visit the "Contact us" page or email us at [your support email] for further assistance.</p>
            </article>
          </div>
        `,
        'Contact us': `
          <div class="footer-content-body contact">
            <h1>Contact Us</h1>
            <p>Have questions, suggestions, or need support? Reach out to us!</p>
            <ul>
              <li>Email: <a href="mailto:cocolovetin@foxmail.com">cocolovetin@foxmail.com</a></li>
            </ul>
            <p>We value your feedback and aim to respond within 24 hours.</p>
          </div>
        `
      };
      const footerContent = document.getElementById('footerContent');
      footerContent.innerHTML = `
        <div style="max-width:820px;margin:48px auto 32px auto;text-align:center;">
          <div style="text-align:left;display:inline-block;width:100%;">
            ${content[type] || ''}
          </div>
        </div>
      `;
      footerContent.style.display = 'block';
      window.scrollTo({top:0,behavior:'smooth'});
      // 隐藏footer以外内容
      document.querySelector('footer').scrollIntoView({behavior:'smooth',block:'end'});
      // 修复：每次渲染FAQ内容后，绑定contact us内链跳转事件
      if(type === 'FAQ') {
        document.querySelectorAll('a[data-footer-link="Contact us"]').forEach(link => {
          link.addEventListener('click', function(e) {
            e.preventDefault();
            // 直接显示Contact us内容
            const type = 'Contact us';
            const content = {
              'Contact us': `
              <div class="footer-content-body contact">
                <h1>Contact Us</h1>
                <p>Have questions, suggestions, or need support? Reach out to us!</p>
                <ul>
                  <li>Email: <a href="mailto:cocolovetin@foxmail.com">cocolovetin@foxmail.com</a></li>
                </ul>
                <p>We value your feedback and aim to respond within 24 hours.</p>
              </div>
              `
            };
            const footerContent = document.getElementById('footerContent');
            footerContent.innerHTML = `
              <div style="max-width:820px;margin:48px auto 32px auto;text-align:center;">
                <div style="text-align:left;display:inline-block;width:100%;">
                  ${content[type] || ''}
                </div>
              </div>
            `;
            footerContent.style.display = 'block';
            window.scrollTo({top:0,behavior:'smooth'});
            document.querySelector('footer').scrollIntoView({behavior:'smooth',block:'end'});
            // 同步SEO和URL
            document.title = 'Contact Us - Picfast';
            let meta = document.querySelector("meta[name='description']");
            if (!meta) {
              meta = document.createElement('meta');
              meta.setAttribute('name', 'description');
              document.head.appendChild(meta);
            }
            meta.setAttribute('content', 'Contact Picfast for support, feedback, or questions about our free image hosting and sharing service. We value your feedback and aim to respond quickly.');
            if (window.location.pathname !== '/contact') {
              window.history.pushState({}, '', '/contact');
            }
          });
        });
      }
    }

    // --- Batch selection and deletion logic ---
    const selectAllBtn = document.getElementById('selectAllBtn');
    const deleteSelectedBtn = document.getElementById('deleteSelectedBtn');
    let allSelected = false;

    // 监听图片列表变化，动态绑定checkbox事件
    function updateCheckboxEvents() {
      const checkboxes = document.querySelectorAll('.image-checkbox');
      checkboxes.forEach(cb => {
        cb.addEventListener('change', updateBatchButtons);
      });
    }

    // 更新按钮状态和Select All文本
    function updateBatchButtons() {
      const checkboxes = document.querySelectorAll('.image-checkbox');
      const checked = Array.from(checkboxes).filter(cb => cb.checked);
      deleteSelectedBtn.disabled = checked.length === 0;
      if (checked.length === checkboxes.length && checkboxes.length > 0) {
        selectAllBtn.textContent = 'Unselect All';
        allSelected = true;
      } else {
        selectAllBtn.textContent = 'Select All';
        allSelected = false;
      }
    }

    // Select All/Unselect All 按钮逻辑
    selectAllBtn.addEventListener('click', () => {
      const checkboxes = document.querySelectorAll('.image-checkbox');
      checkboxes.forEach(cb => { cb.checked = !allSelected; });
      updateBatchButtons();
    });

    // 批量删除按钮逻辑
    deleteSelectedBtn.addEventListener('click', async () => {
      const checkboxes = document.querySelectorAll('.image-checkbox:checked');
      if (checkboxes.length === 0) return;
      showBatchDeleteModal(checkboxes.length, async () => {
        deleteSelectedBtn.disabled = true;
        // 直接批量请求后端删除接口，不再调用deleteImage（避免重复弹窗）
        for (const cb of checkboxes) {
          const id = cb.getAttribute('data-id');
          const btn = cb.closest('.image-item').querySelector('.delete-btn');
          btn.disabled = true;
          btn.textContent = 'Deleting...';
          try {
            await fetch(`/delete/${id}`, { method: 'DELETE' });
            cb.closest('.image-item').remove();
          } catch {}
        }
        setTimeout(() => { loadImageList(); }, 500);
      });
    });

    // 批量删除自定义弹窗逻辑
    function showBatchDeleteModal(count, onConfirm) {
      const deleteModal = document.getElementById('deleteModal');
      const confirmBtn = document.getElementById('deleteConfirmBtn');
      const cancelBtn = document.getElementById('deleteCancelBtn');
      // 修改弹窗内容
      deleteModal.querySelector('h3').textContent = 'Confirm Deletion';
      deleteModal.querySelector('p').textContent = `Are you sure you want to delete ${count} selected image(s)?`;
      deleteModal.style.display = 'block';
      // 解绑旧事件
      confirmBtn.onclick = null;
      cancelBtn.onclick = null;
      // 绑定新事件
      confirmBtn.onclick = async () => {
        deleteModal.style.display = 'none';
        if (onConfirm) {
          await onConfirm();
        }
      };
      cancelBtn.onclick = () => {
        deleteModal.style.display = 'none';
      };
      // 点击遮罩关闭
      deleteModal.onclick = (e) => {
        if (e.target === deleteModal) {
          deleteModal.style.display = 'none';
        }
      };
      // Esc关闭
      const handleEscape = (e) => {
        if (e.key === 'Escape') {
          deleteModal.style.display = 'none';
          document.removeEventListener('keydown', handleEscape);
        }
      };
      document.addEventListener('keydown', handleEscape);
    }

    // 在图片列表渲染后绑定checkbox事件
    const origLoadImageList = loadImageList;
    loadImageList = async function() {
      await origLoadImageList.apply(this, arguments);
      updateCheckboxEvents();
      updateBatchButtons();
    };

    // --- Back to Top button logic ---
    const backToTopBtn = document.getElementById('backToTopBtn');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 200) {
        backToTopBtn.classList.add('show');
      } else {
        backToTopBtn.classList.remove('show');
      }
    });
    backToTopBtn.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // 动态SEO元信息优化 for My Images
    function setMeta(name, content) {
      let meta = document.querySelector(`meta[name='${name}']`);
      if (!meta) {
        meta = document.createElement('meta');
        meta.setAttribute('name', name);
        document.head.appendChild(meta);
      }
      meta.setAttribute('content', content);
    }
    function setMyImagesSEO() {
      document.title = 'My Images - Manage & Share | Picfast';
      setMeta('description', 'Manage your uploaded images on Picfast. Copy links, batch delete, and organize your image uploads easily.');
    }
    function setHomeSEO() {
      document.title = 'Picfast - Free Image Upload & Share | Fast Image Hosting';
      setMeta('description', 'Picfast is a free, fast, and reliable image upload and hosting service. Instantly upload your pictures and get shareable links for forums, blogs, social media, and more. No registration required.');
    }
    // 在切换页面时动态设置SEO
    document.getElementById('myImagesLink').addEventListener('click', function() {
      setMyImagesSEO();
    });
    document.getElementById('mobileMyImagesLink').addEventListener('click', function() {
      setMyImagesSEO();
    });
    document.getElementById('uploadLink').addEventListener('click', function() {
      setHomeSEO();
    });
    document.getElementById('mobileUploadLink').addEventListener('click', function() {
      setHomeSEO();
    });
    // 页面首次加载默认首页SEO
    setHomeSEO();

    function setWindowsAppSEO() {
      document.title = 'Windows App - Picfast';
      setMeta('description', 'Download the Picfast Windows App for fast and easy image uploads directly from your desktop. Coming soon!');
    }
    document.getElementById('windowsAppLink').addEventListener('click', function() {
      setWindowsAppSEO();
    });
    document.getElementById('mobileWindowsAppLink').addEventListener('click', function() {
      setWindowsAppSEO();
    });

    function setAboutSEO() {
      document.title = 'About Picfast - Free Image Hosting & Sharing';
      setMeta('description', 'Learn more about Picfast, our mission, and why thousands trust us for free, fast, and reliable image hosting and sharing.');
    }
    document.querySelectorAll('.footer-link').forEach(link => {
      if (link.textContent === 'About') {
        link.addEventListener('click', function() { setAboutSEO(); });
      }
    });

    function setTermsSEO() {
      document.title = 'Terms of Use - Picfast';
      setMeta('description', 'Read the terms of use for Picfast. Understand the rules and policies for uploading and sharing images on our platform.');
    }
    document.querySelectorAll('.footer-link').forEach(link => {
      if (link.textContent === 'Terms of Use') {
        link.addEventListener('click', function() { setTermsSEO(); });
      }
    });

    function setPrivacySEO() {
      document.title = 'Privacy Policy - Picfast';
      setMeta('description', 'Read the privacy policy of Picfast. Learn how we protect your data and respect your privacy when you use our image hosting service.');
    }
    document.querySelectorAll('.footer-link').forEach(link => {
      if (link.textContent === 'Privacy Policy') {
        link.addEventListener('click', function() { setPrivacySEO(); });
      }
    });

    function setFAQSEO() {
      document.title = 'FAQ - Picfast';
      setMeta('description', 'Frequently Asked Questions about Picfast. Find answers to common questions about image upload, sharing, formats, and more.');
    }
    document.querySelectorAll('.footer-link').forEach(link => {
      if (link.textContent === 'FAQ') {
        link.addEventListener('click', function() { setFAQSEO(); });
      }
    });

    function setContactSEO() {
      document.title = 'Contact Us - Picfast';
      setMeta('description', 'Contact Picfast for support, feedback, or questions about our free image hosting and sharing service. We value your feedback and aim to respond quickly.');
    }
    document.querySelectorAll('.footer-link').forEach(link => {
      if (link.textContent === 'Contact us') {
        link.addEventListener('click', function() { setContactSEO(); });
      }
    });

    function setLanguagesSEO() {
      document.title = 'Languages - Picfast';
      setMeta('description', 'Choose your preferred language for the Picfast image hosting platform. Multilingual support coming soon!');
    }
    document.querySelectorAll('.footer-link').forEach(link => {
      if (link.textContent === 'Languages') {
        link.addEventListener('click', function() { setLanguagesSEO(); });
      }
    });

    function setUploadByURLSEO() {
      document.title = 'Upload by URL - Picfast';
      setMeta('description', 'Upload images to Picfast directly from a URL. Fast, free, and reliable image hosting for all your needs.');
    }
    document.querySelectorAll('.footer-link').forEach(link => {
      if (link.textContent === 'Upload by URL') {
        link.addEventListener('click', function() { setUploadByURLSEO(); });
      }
    });

    function setWebsitePluginsSEO() {
      document.title = 'Website Plugins - Picfast';
      setMeta('description', 'Integrate Picfast image hosting with your website using our plugins. Fast, free, and easy image upload solutions for webmasters.');
    }
    document.querySelectorAll('.footer-link').forEach(link => {
      if (link.textContent === 'Website plugins') {
        link.addEventListener('click', function() { setWebsitePluginsSEO(); });
      }
    });

    // Windows App按钮URL美化（主导航和移动端）
    document.getElementById('windowsAppLink').addEventListener('click', function(e) {
      e.preventDefault();
      hideFooterContentIfShown();
      showToast('Windows App coming soon!');
      setTimeout(() => { updateUrl('/windows-app'); }, 0);
    });
    document.getElementById('mobileWindowsAppLink').addEventListener('click', function(e) {
      e.preventDefault();
      hideFooterContentIfShown();
      showToast('Windows App coming soon!');
      setTimeout(() => { updateUrl('/windows-app'); }, 0);
      closeMobileMenu();
    });
    // Login/Sign Up按钮URL美化
    document.querySelectorAll('.login-btn, .mobile-login-btn').forEach(btn => {
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        showToast('Login coming soon!');
        setTimeout(() => { updateUrl('/login'); }, 0);
      });
    });
    document.querySelectorAll('.signup-btn, .mobile-signup-btn').forEach(btn => {
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        showToast('Sign Up coming soon!');
        setTimeout(() => { updateUrl('/signup'); }, 0);
      });
    });

    // FAQ顶部contact us内链跳转Contact us页面（直接调用footer内容切换逻辑）
    document.querySelectorAll('a[data-footer-link="Contact us"]').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        // 直接显示Contact us内容
        const type = 'Contact us';
        const content = {
          'Contact us': `
          <div class="footer-content-body contact">
            <h1>Contact Us</h1>
            <p>Have questions, suggestions, or need support? Reach out to us!</p>
            <ul>
              <li>Email: <a href="mailto:cocolovetin@foxmail.com">cocolovetin@foxmail.com</a></li>
            </ul>
            <p>We value your feedback and aim to respond within 24 hours.</p>
          </div>
        `
        };
        const footerContent = document.getElementById('footerContent');
        footerContent.innerHTML = `
          <div style="max-width:820px;margin:48px auto 32px auto;text-align:center;">
            <div style="text-align:left;display:inline-block;width:100%;">
              ${content[type] || ''}
            </div>
          </div>
        `;
        footerContent.style.display = 'block';
        window.scrollTo({top:0,behavior:'smooth'});
        document.querySelector('footer').scrollIntoView({behavior:'smooth',block:'end'});
        // 同步SEO和URL
        document.title = 'Contact Us - Picfast';
        let meta = document.querySelector("meta[name='description']");
        if (!meta) {
          meta = document.createElement('meta');
          meta.setAttribute('name', 'description');
          document.head.appendChild(meta);
        }
        meta.setAttribute('content', 'Contact Picfast for support, feedback, or questions about our free image hosting and sharing service. We value your feedback and aim to respond quickly.');
        if (window.location.pathname !== '/contact') {
          window.history.pushState({}, '', '/contact');
        }
      });
    });
  </script>
  <style>
    /* 优化toast弹窗移动端适配 */
    #toast {
      max-width: 92vw;
      min-width: 120px;
      font-size: 1.13rem;
      padding: 20px 8vw;
      word-break: break-word;
    }
    @media (max-width: 600px) {
      #toast {
        font-size: 1.01rem;
        padding: 14px 6vw;
        min-width: 100px;
        max-width: 98vw;
      }
    }
  </style>
  <style>
    .footer-content-body {
      line-height: 1.7;
      font-size: 1.18rem;
    }
    .footer-content-body h1 {
      font-size: 2.6rem;
      font-weight: bold;
      margin-bottom: 1.2em;
    }
    .footer-content-body h2 {
      font-size: 1.5rem;
      font-weight: bold;
      margin-top: 1.5em;
      margin-bottom: 0.7em;
    }
    @media (max-width: 600px) {
      .footer-content-body {
        font-size: 1.01rem;
        padding-left: 8px;
        padding-right: 8px;
        line-height: 1.55;
      }
      .footer-content-body h1 {
        font-size: 2rem;
        margin-bottom: 0.8em;
        word-break: break-word;
        text-align: center;
      }
      .footer-content-body h2 {
        font-size: 1.13rem;
        margin-top: 1.1em;
        margin-bottom: 0.5em;
        text-align: left;
      }
      .footer-content-body ul {
        padding-left: 1.1em;
        margin-bottom: 1em;
      }
      #footerContent > div {
        margin: 18px auto 12px auto !important;
        max-width: 99vw !important;
      }
      #backToMainBtn {
        width: 90%;
        min-width: 0;
        font-size: 1.01rem !important;
        padding: 12px 0 !important;
        margin-top: 18px !important;
        margin-bottom: 8px !important;
      }
    }
  </style>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const backToTopBtn = document.getElementById('backToTopBtn');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 200) {
          backToTopBtn.classList.add('show');
        } else {
          backToTopBtn.classList.remove('show');
        }
      });
      backToTopBtn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    });
  </script>
  <button id="backToTopBtn" aria-label="Back to top">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>
  </button>

  <script>
    // 1. 生成并保存访客ID
    function getVisitorId() {
      let id = localStorage.getItem('visitor_id');
      if (!id) {
        if (window.crypto && window.crypto.randomUUID) {
          id = crypto.randomUUID();
        } else {
          // 兼容老浏览器
          id = 'v_' + Math.random().toString(36).substr(2, 16) + Date.now();
        }
        localStorage.setItem('visitor_id', id);
      }
      return id;
    }
  </script>
</body>
</html> 